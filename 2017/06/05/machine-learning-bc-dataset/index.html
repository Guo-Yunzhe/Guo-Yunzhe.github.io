<!DOCTYPE html><html lang="zh-TW"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="This is GuoYunzhe's blog."><title>机器学习实践-针对Breast-Cancer数据集 | GuoYunzhe's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">机器学习实践-针对Breast-Cancer数据集</h1><a id="logo" href="/.">GuoYunzhe's Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首頁</i></a><a href="/archives/"><i class="fa fa-archive"> 所有文章</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">机器学习实践-针对Breast-Cancer数据集</h1><div class="post-meta">Jun 5, 2017<span> | </span><span class="category"><a href="/categories/开发/">开发</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 閱讀</span></span></div><div class="post-content"><p>本篇博客中，我们将对一个UCI数据库中的数据集：Breast-Cancer数据集，应用已有的机器学习方法来实现一个分类器。</p>
<p><a href="http://code.guoyunzhe.net/ml/breast-cancer-dataset-try.py" target="_blank" rel="external">本文代码链接</a></p>
<h2 id="数据集概况"><a href="#数据集概况" class="headerlink" title="数据集概况"></a>数据集概况</h2><p>数据集的地址为：<a href="http://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+(Original" target="_blank" rel="external">link</a>)</p>
<p>在该页面中，可以进入<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.names" target="_blank" rel="external">Data Set Description</a> 来查看数据的说明文档，另外一个连接是<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/" target="_blank" rel="external">Data Folder</a> 查看数据集的下载地址。</p>
<p>这里我们使用的文件是：</p>
<ul>
<li>breast-cancer-wisconsin.data </li>
<li>breast-cancer-wisconsin.names</li>
</ul>
<p>即：</p>
<p><img src="https://ogeo14x4j.qnssl.com/breast-cancer/breast-cancer-dataset-Snip20170523_7.png" alt="snip-breast-cancer"></p>
<p>这两个文件，第一个文件（<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.data" target="_blank" rel="external">连接</a>）是我们的数据文件，第二个文件（<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.names" target="_blank" rel="external">连接</a>）是数据的说明文档。</p>
<p>对于这样的一份数据，我们应该首先阅读说明文档中的内容来对数据有一个基本的了解。</p>
<h2 id="对数据的预处理"><a href="#对数据的预处理" class="headerlink" title="对数据的预处理"></a>对数据的预处理</h2><p>我们可以知道文件有11个列，第1个列为id号，第2-10列为特征，11列为标签（2为良性、4为恶性）。具体的特征内容在文档中，但是我们可以不关心医学上的具体意义，这部分在文档中的描述如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">7. Attribute Information: (class attribute has been moved to last column)</div><div class="line"></div><div class="line">   #  Attribute                     Domain</div><div class="line">   -- -----------------------------------------</div><div class="line">   1. Sample code number            id number</div><div class="line">   2. Clump Thickness               1 - 10</div><div class="line">   3. Uniformity of Cell Size       1 - 10</div><div class="line">   4. Uniformity of Cell Shape      1 - 10</div><div class="line">   5. Marginal Adhesion             1 - 10</div><div class="line">   6. Single Epithelial Cell Size   1 - 10</div><div class="line">   7. Bare Nuclei                   1 - 10</div><div class="line">   8. Bland Chromatin               1 - 10</div><div class="line">   9. Normal Nucleoli               1 - 10</div><div class="line">  10. Mitoses                       1 - 10</div><div class="line">  11. Class:                        (2 for benign, 4 for malignant)</div></pre></td></tr></table></figure>
<p>另外从文档中我们还可以知道一些其他的信息：</p>
<ul>
<li>数据集中共有699条信息</li>
<li>数据集中有16处缺失值，缺失值使用”?”表示</li>
<li>数据集中良性数据有458条，恶性数据有241条</li>
</ul>
<h2 id="缺失值处理和分割数据集"><a href="#缺失值处理和分割数据集" class="headerlink" title="缺失值处理和分割数据集"></a>缺失值处理和分割数据集</h2><p>因为缺失的数据不多（11条），所以我们暂时先采用丢弃带有“？”的数据，加上前面读取数据、添加表头的操作，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"># import the packets</div><div class="line">import numpy as np</div><div class="line">import pandas as pd</div><div class="line"></div><div class="line">DATA_PATH = &quot;breast-cancer-wisconsin.data&quot;</div><div class="line"></div><div class="line"># create the column names</div><div class="line">columnNames = [</div><div class="line">    &apos;Sample code number&apos;,</div><div class="line">    &apos;Clump Thickness&apos;,</div><div class="line">    &apos;Uniformity of Cell Size&apos;,</div><div class="line">    &apos;Uniformity of Cell Shape&apos;,</div><div class="line">    &apos;Marginal Adhesion&apos;,</div><div class="line">    &apos;Single Epithelial Cell Size&apos;,</div><div class="line">    &apos;Bare Nuclei&apos;,</div><div class="line">    &apos;Bland Chromatin&apos;,</div><div class="line">    &apos;Normal Nucleoli&apos;,</div><div class="line">    &apos;Mitoses&apos;,</div><div class="line">    &apos;Class&apos;</div><div class="line">]</div><div class="line"></div><div class="line">data = pd.read_csv(DATA_PATH, names = columnNames)</div><div class="line"># show the shape of data</div><div class="line">print data.shape</div><div class="line"></div><div class="line"># use standard missing value to replace &quot;?&quot;</div><div class="line">data = data.replace(to_replace = &quot;?&quot;, value = np.nan)</div><div class="line"># then drop the missing value</div><div class="line">data = data.dropna(how = &apos;any&apos;)</div><div class="line"></div><div class="line">print data.shape</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(699, 11)</div><div class="line">(683, 11)</div></pre></td></tr></table></figure>
<p>可以看到，现在数据中带有缺失值的数据都被丢弃掉了。</p>
<p>我们可以通过类似 <code>data[&#39;Class&#39;]</code> 的方式来访问特定的属性，如下图：</p>
<p><img src="http://img.guoyunzhe.net/ml/Snip20170525_1.png" alt="data-Class "></p>
<p>然后我们会将数据集分割为两部分：训练数据集和测试数据集，使用了<code>train_test_split</code>，这个函数已经自动完成了随机分割的功能，<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html#sklearn.model_selection.train_test_split" target="_blank" rel="external">函数文档</a> 。</p>
<p>然后我们分割数据集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from sklearn.model_selection import train_test_split</div><div class="line"></div><div class="line">X_train, X_test, y_train, y_test = train_test_split(</div><div class="line">    data[ columnNames[1:10] ], # features</div><div class="line">    data[ columnNames[10]   ], # labels</div><div class="line">    test_size = 0.25,</div><div class="line">    random_state = 33</div><div class="line">)</div></pre></td></tr></table></figure>
<p>得到的变量为：</p>
<ul>
<li>X_train ： 训练数据集的特征</li>
<li>X_test ：测试数据集的特征</li>
<li>y_train ：训练数据集的标签</li>
<li>y_test ：测试数据集的标签</li>
</ul>
<p>因为是<strong>监督学习</strong>，所以所有数据都有标签，且认为标签的内容百分之百准确。</p>
<h2 id="应用机器学习模型"><a href="#应用机器学习模型" class="headerlink" title="应用机器学习模型"></a>应用机器学习模型</h2><p>应用机器模型前，应该将每个特征的数值转化为均值为0，方差为1的数据，使训练出的模型不会被某些维度过大的值主导。</p>
<p>这里使用的使<code>scikit-learn</code> 中的 <code>StandardScaler</code> 模块，<a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" target="_blank" rel="external">doc链接</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">from sklearn.preprocessing import StandardScaler</div><div class="line"></div><div class="line">ss = StandardScaler()</div><div class="line">X_train = ss.fit_transform(X_train) # fit_transform for train data</div><div class="line">X_test = ss.transform(X_test)</div></pre></td></tr></table></figure>
<p>然后我们将建立一个机器学习模型， 这里我们使用了Logestic Regression 和 SVM：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># use logestic-regression</div><div class="line">from sklearn.linear_model import LogisticRegression</div><div class="line">lr = LogisticRegression()</div><div class="line">lr.fit(X_train, y_train)</div><div class="line">lr_y = lr.predict(X_test)</div><div class="line"></div><div class="line"># use svm</div><div class="line">from sklearn.svm import LinearSVC</div><div class="line">lsvc = LinearSVC()</div><div class="line">lsvc.fit(X_train, y_train)</div><div class="line">svm_y = lsvc.predict(X_test)</div></pre></td></tr></table></figure>
<h2 id="分类器的效果评估"><a href="#分类器的效果评估" class="headerlink" title="分类器的效果评估"></a>分类器的效果评估</h2><p>首先我们用分类器自带的<code>.score</code>方法来对准确性进行打印：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># now we will check the performance of the classifier</div><div class="line">from sklearn.metrics import classification_report</div><div class="line"># use the classification_report to present result</div><div class="line"># `.score` method can be used to test the accuracy</div><div class="line">print &apos;Accuracy of the LogesticRegression: &apos;, lr.score(X_test, y_test)</div><div class="line"># print &apos;Accuracy on the train dataset: &apos;, lr.score(X_train, y_train)</div><div class="line"># print &apos;Accuracy on the predict result (should be 1.0): &apos;, lr.score(X_test, lr_y)</div><div class="line">print &apos;Accuracy of the SVM: &apos; , lsvc.score(X_test, y_test)</div></pre></td></tr></table></figure>
<p>输出为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Accuracy of the LogesticRegression:  0.953216374269</div><div class="line">Accuracy of the SVM:  0.959064327485</div></pre></td></tr></table></figure>
<p>除此以外，我们还可以使用<code>classification_report</code>对分类器查看更详细的性能测试结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print classification_report(y_test, svm_y, target_names = [&apos;Benign&apos;, &apos;Malignant&apos;])</div></pre></td></tr></table></figure>
<p>其结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">             precision    recall  f1-score   support</div><div class="line"></div><div class="line">     Benign       0.96      0.98      0.97       111</div><div class="line">  Malignant       0.96      0.92      0.94        60</div><div class="line"></div><div class="line">avg / total       0.96      0.96      0.96       171</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://youtsite.com/2017/06/05/machine-learning-bc-dataset/" data-id="cj5w6ttmx000ppb7e536enm2o" class="article-share-link">分享</a><div class="tags"><a href="/tags/python/">python</a><a href="/tags/maching-learning/">maching learning</a></div><div class="post-nav"><a href="/2017/05/31/mac-selenium/" class="next">Mac下Selenium + Python配置</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://youtsite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分類</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/开发/">开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/配置/">配置</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 標籤</i></div><div class="tagcloud"><a href="/tags/crytography/" style="font-size: 15px;">crytography</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/unix/" style="font-size: 15px;">unix</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/matlab/" style="font-size: 15px;">matlab</a> <a href="/tags/maching-learning/" style="font-size: 15px;">maching learning</a> <a href="/tags/web-spider/" style="font-size: 15px;">web-spider</a> <a href="/tags/selenium/" style="font-size: 15px;">selenium</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/06/05/machine-learning-bc-dataset/">机器学习实践-针对Breast-Cancer数据集</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/31/mac-selenium/">Mac下Selenium + Python配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/15/linear-regression/">一个线性回归的一个简单例子</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/APUE-H/">在OS X 10.11 中使用 "apue.h"</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/20/aes128/">C++ 实现 AES128 加密算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/12/simple-KNN/">K临近算法的一个简单例子</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/11/numpy-walkthrough/">熟悉Numpy</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/10/android-button/">Android开发：按钮</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/25/mac-scrapy-installation/">Mac安装Scrapy</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/05/two-sum/">LeetCode(1) twoSum</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友站連接</i></div><ul></ul><a href="https://cookiezh.github.io/" title="土豆儿的博客" target="_blank">土豆儿的博客</a><ul></ul><a href="http://3ch0.cn/" title="Yasuo.Li's Blog" target="_blank">Yasuo.Li's Blog</a><ul></ul><a href="https://github.com/Guo-Yunzhe" title="My Github Page" target="_blank">My Github Page</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">GuoYunzhe's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>